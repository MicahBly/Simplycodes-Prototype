import{r as h,g as D,R as N,j as s,M as $,C as A,c as R}from"../chunks/ModelStatus.Cu0Do625.js";import{M as T}from"../chunks/index.C2vGlvdN.js";const I={},j=e=>{let t;const o=new Set,n=(c,p)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const u=t;t=p??(typeof d!="object"||d===null)?d:Object.assign({},t,d),o.forEach(a=>a(t,u))}},r=()=>t,m={setState:n,getState:r,getInitialState:()=>f,subscribe:c=>(o.add(c),()=>o.delete(c)),destroy:()=>{(I?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},f=t=e(n,r,m);return m},O=e=>e?j(e):j;var C={exports:{}},_={},M={exports:{}},k={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=h;function P(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var V=typeof Object.is=="function"?Object.is:P,W=g.useState,F=g.useEffect,z=g.useLayoutEffect,B=g.useDebugValue;function U(e,t){var o=t(),n=W({inst:{value:o,getSnapshot:t}}),r=n[0].inst,i=n[1];return z(function(){r.value=o,r.getSnapshot=t,b(r)&&i({inst:r})},[e,o,t]),F(function(){return b(r)&&i({inst:r}),e(function(){b(r)&&i({inst:r})})},[e]),B(o),o}function b(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!V(e,o)}catch{return!0}}function G(e,t){return t()}var H=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?G:U;k.useSyncExternalStore=g.useSyncExternalStore!==void 0?g.useSyncExternalStore:H;M.exports=k;var Y=M.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y=h,J=Y;function K(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Q=typeof Object.is=="function"?Object.is:K,X=J.useSyncExternalStore,Z=y.useRef,q=y.useEffect,ee=y.useMemo,te=y.useDebugValue;_.useSyncExternalStoreWithSelector=function(e,t,o,n,r){var i=Z(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=ee(function(){function m(u){if(!f){if(f=!0,c=u,u=n(u),r!==void 0&&l.hasValue){var a=l.value;if(r(a,u))return p=a}return p=u}if(a=p,Q(c,u))return a;var x=n(u);return r!==void 0&&r(a,x)?(c=u,a):(c=u,p=x)}var f=!1,c,p,d=o===void 0?null:o;return[function(){return m(t())},d===null?void 0:function(){return m(d())}]},[t,o,n,r]);var v=X(e,i[0],i[1]);return q(function(){l.hasValue=!0,l.value=v},[v]),te(v),v};C.exports=_;var se=C.exports;const oe=D(se),L={},{useDebugValue:re}=N,{useSyncExternalStoreWithSelector:ne}=oe;let w=!1;const ae=e=>e;function ie(e,t=ae,o){(L?"production":void 0)!=="production"&&o&&!w&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),w=!0);const n=ne(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,o);return re(n),n}const E=e=>{(L?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?O(e):e,o=(n,r)=>ie(t,n,r);return Object.assign(o,t),o},ce=e=>e?E(e):E,S=ce(e=>({modelStatus:"loading",settings:{autoApply:!0,showNotifications:!0,privacyMode:!0},statistics:{totalSaved:0,couponsApplied:0},setModelStatus:t=>e({modelStatus:t}),updateSettings:t=>e(o=>({settings:{...o.settings,...t}})),updateStatistics:t=>e(o=>({statistics:{...o.statistics,...t}})),incrementSaved:t=>e(o=>({statistics:{...o.statistics,totalSaved:o.statistics.totalSaved+t}}))}));typeof chrome<"u"&&chrome.storage&&(chrome.storage.local.get(["settings","statistics"],e=>{e.settings&&S.getState().updateSettings(e.settings),e.statistics&&S.getState().updateStatistics(e.statistics)}),chrome.storage.onChanged.addListener((e,t)=>{t==="local"&&(e.settings&&S.getState().updateSettings(e.settings.newValue),e.statistics&&S.getState().updateStatistics(e.statistics.newValue))}));function ue(){const[e,t]=h.useState([]),[o,n]=h.useState(!0),[r,i]=h.useState(null),[l,v]=h.useState(null),{modelStatus:m,statistics:f}=S();h.useEffect(()=>{c()},[]),h.useEffect(()=>{r?.url&&p()},[r]);const c=async()=>{const[a]=await chrome.tabs.query({active:!0,currentWindow:!0});i(a)},p=async()=>{if(r?.url){n(!0);try{const a=new URL(r.url),x=await chrome.runtime.sendMessage({type:"GET_COUPONS",payload:{domain:a.hostname,cartTotal:l}});x.success&&t(x.data.coupons)}catch(a){console.error("Failed to load coupons:",a)}finally{n(!1)}}},d=async()=>{if(e.length===0||!r?.id)return;const a=e[0],x=await chrome.runtime.sendMessage({type:"APPLY_COUPON",payload:{code:a.code,tabId:r.id}});x.success?(await chrome.storage.local.set({statistics:{...f,couponsApplied:f.couponsApplied+1}}),alert("Coupon applied successfully!")):alert(`Failed to apply coupon: ${x.error}`)},u=r?.url&&T.isSiteSupported(new URL(r.url).hostname);return s.jsxs("div",{className:"w-96 h-[600px] bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"bg-white shadow-sm px-4 py-3 border-b",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"SimplyCodes"}),s.jsx($,{status:m})]})}),s.jsx("main",{className:"flex-1 overflow-auto",children:u?o?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Loading coupons..."})]}):e.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Coupons Available"}),s.jsx("p",{className:"text-sm text-gray-600",children:"We couldn't find any active coupons for this site right now."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 bg-white border-b",children:[s.jsxs("button",{onClick:d,className:"w-full btn-primary flex items-center justify-center gap-2",disabled:m!=="ready",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Apply Best Deal"]}),l&&s.jsxs("p",{className:"text-sm text-gray-600 text-center mt-2",children:["Cart Total: $",l.toFixed(2)]})]}),s.jsx(A,{coupons:e,onApply:()=>{}})]}):s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Site Not Supported"}),s.jsx("p",{className:"text-sm text-gray-600",children:"SimplyCodes works on major e-commerce sites. Navigate to a supported site to see available deals."})]})}),s.jsx("footer",{className:"bg-white border-t px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"text-gray-600",children:["Total Saved: ",s.jsxs("span",{className:"font-medium text-green-600",children:["$",f.totalSaved.toFixed(2)]})]}),s.jsx("button",{onClick:()=>chrome.runtime.openOptionsPage(),className:"text-primary-600 hover:text-primary-700",children:"Settings"})]})})]})}R.createRoot(document.getElementById("root")).render(s.jsx(N.StrictMode,{children:s.jsx(ue,{})}));
