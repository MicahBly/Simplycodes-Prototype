(function(){"use strict";function E(r){return Array.isArray?Array.isArray(r):q(r)==="[object Array]"}function ft(r){if(typeof r=="string")return r;let t=r+"";return t=="0"&&1/r==-1/0?"-0":t}function _t(r){return r==null?"":ft(r)}function y(r){return typeof r=="string"}function Z(r){return typeof r=="number"}function mt(r){return r===!0||r===!1||bt(r)&&q(r)=="[object Boolean]"}function J(r){return typeof r=="object"}function bt(r){return J(r)&&r!==null}function _(r){return r!=null}function N(r){return!r.trim().length}function q(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const At="Incorrect 'index' type",Ct=r=>`Invalid value for key ${r}`,yt=r=>`Pattern length exceeds max of ${r}.`,Et=r=>`Missing ${r} property in key`,wt=r=>`Property 'weight' in key '${r}' must be a positive integer`,tt=Object.prototype.hasOwnProperty;class St{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach(i=>{let s=et(i);this._keys.push(s),this._keyMap[s.id]=s,e+=s.weight}),this._keys.forEach(i=>{i.weight/=e})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function et(r){let t=null,e=null,i=null,s=1,n=null;if(y(r)||E(r))i=r,t=rt(r),e=$(r);else{if(!tt.call(r,"name"))throw new Error(Et("name"));const o=r.name;if(i=o,tt.call(r,"weight")&&(s=r.weight,s<=0))throw new Error(wt(o));t=rt(o),e=$(o),n=r.getFn}return{path:t,id:e,weight:s,src:i,getFn:n}}function rt(r){return E(r)?r:r.split(".")}function $(r){return E(r)?r.join("."):r}function Mt(r,t){let e=[],i=!1;const s=(n,o,c)=>{if(_(n))if(!o[c])e.push(n);else{let a=o[c];const u=n[a];if(!_(u))return;if(c===o.length-1&&(y(u)||Z(u)||mt(u)))e.push(_t(u));else if(E(u)){i=!0;for(let l=0,h=u.length;l<h;l+=1)s(u[l],o,c+1)}else o.length&&s(u,o,c+1)}};return s(r,y(t)?t.split("."):t,0),i?e:e[0]}var d={...{isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(r,t)=>r.score===t.score?r.idx<t.idx?-1:1:r.score<t.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:Mt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const xt=/[^ ]+/g;function Bt(r=1,t=3){const e=new Map,i=Math.pow(10,t);return{get(s){const n=s.match(xt).length;if(e.has(n))return e.get(n);const o=1/Math.pow(n,.5*r),c=parseFloat(Math.round(o*i)/i);return e.set(n,c),c},clear(){e.clear()}}}class H{constructor({getFn:t=d.getFn,fieldNormWeight:e=d.fieldNormWeight}={}){this.norm=Bt(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((e,i)=>{this._keysMap[e.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,y(this.docs[0])?this.docs.forEach((t,e)=>{this._addString(t,e)}):this.docs.forEach((t,e)=>{this._addObject(t,e)}),this.norm.clear())}add(t){const e=this.size();y(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,i=this.size();e<i;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!_(t)||N(t))return;let i={v:t,i:e,n:this.norm.get(t)};this.records.push(i)}_addObject(t,e){let i={i:e,$:{}};this.keys.forEach((s,n)=>{let o=s.getFn?s.getFn(t):this.getFn(t,s.path);if(_(o)){if(E(o)){let c=[];const a=[{nestedArrIndex:-1,value:o}];for(;a.length;){const{nestedArrIndex:u,value:l}=a.pop();if(_(l))if(y(l)&&!N(l)){let h={v:l,i:u,n:this.norm.get(l)};c.push(h)}else E(l)&&l.forEach((h,p)=>{a.push({nestedArrIndex:p,value:h})})}i.$[n]=c}else if(y(o)&&!N(o)){let c={v:o,n:this.norm.get(o)};i.$[n]=c}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function it(r,t,{getFn:e=d.getFn,fieldNormWeight:i=d.fieldNormWeight}={}){const s=new H({getFn:e,fieldNormWeight:i});return s.setKeys(r.map(et)),s.setSources(t),s.create(),s}function Dt(r,{getFn:t=d.getFn,fieldNormWeight:e=d.fieldNormWeight}={}){const{keys:i,records:s}=r,n=new H({getFn:t,fieldNormWeight:e});return n.setKeys(i),n.setIndexRecords(s),n}function T(r,{errors:t=0,currentLocation:e=0,expectedLocation:i=0,distance:s=d.distance,ignoreLocation:n=d.ignoreLocation}={}){const o=t/r.length;if(n)return o;const c=Math.abs(i-e);return s?o+c/s:c?1:o}function vt(r=[],t=d.minMatchCharLength){let e=[],i=-1,s=-1,n=0;for(let o=r.length;n<o;n+=1){let c=r[n];c&&i===-1?i=n:!c&&i!==-1&&(s=n-1,s-i+1>=t&&e.push([i,s]),i=-1)}return r[n-1]&&n-i>=t&&e.push([i,n-1]),e}const D=32;function Ft(r,t,e,{location:i=d.location,distance:s=d.distance,threshold:n=d.threshold,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,includeMatches:a=d.includeMatches,ignoreLocation:u=d.ignoreLocation}={}){if(t.length>D)throw new Error(yt(D));const l=t.length,h=r.length,p=Math.max(0,Math.min(i,h));let g=n,f=p;const m=c>1||a,A=m?Array(h):[];let M;for(;(M=r.indexOf(t,f))>-1;){let b=T(t,{currentLocation:M,expectedLocation:p,distance:s,ignoreLocation:u});if(g=Math.min(b,g),f=M+l,m){let x=0;for(;x<l;)A[M+x]=1,x+=1}}f=-1;let w=[],k=1,v=l+h;const re=1<<l-1;for(let b=0;b<l;b+=1){let x=0,B=v;for(;x<B;)T(t,{errors:b,currentLocation:p+B,expectedLocation:p,distance:s,ignoreLocation:u})<=g?x=B:v=B,B=Math.floor((v-x)/2+x);v=B;let pt=Math.max(1,p-B+1),X=o?h:Math.min(p+B,h)+l,I=Array(X+2);I[X+1]=(1<<b)-1;for(let C=X;C>=pt;C-=1){let R=C-1,gt=e[r.charAt(R)];if(m&&(A[R]=+!!gt),I[C]=(I[C+1]<<1|1)&gt,b&&(I[C]|=(w[C+1]|w[C])<<1|1|w[C+1]),I[C]&re&&(k=T(t,{errors:b,currentLocation:R,expectedLocation:p,distance:s,ignoreLocation:u}),k<=g)){if(g=k,f=R,f<=p)break;pt=Math.max(1,2*p-f)}}if(T(t,{errors:b+1,currentLocation:p,expectedLocation:p,distance:s,ignoreLocation:u})>g)break;w=I}const Q={isMatch:f>=0,score:Math.max(.001,k)};if(m){const b=vt(A,c);b.length?a&&(Q.indices=b):Q.isMatch=!1}return Q}function kt(r){let t={};for(let e=0,i=r.length;e<i;e+=1){const s=r.charAt(e);t[s]=(t[s]||0)|1<<i-e-1}return t}const L=String.prototype.normalize?r=>r.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):r=>r;class st{constructor(t,{location:e=d.location,threshold:i=d.threshold,distance:s=d.distance,includeMatches:n=d.includeMatches,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,isCaseSensitive:a=d.isCaseSensitive,ignoreDiacritics:u=d.ignoreDiacritics,ignoreLocation:l=d.ignoreLocation}={}){if(this.options={location:e,threshold:i,distance:s,includeMatches:n,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreDiacritics:u,ignoreLocation:l},t=a?t:t.toLowerCase(),t=u?L(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const h=(g,f)=>{this.chunks.push({pattern:g,alphabet:kt(g),startIndex:f})},p=this.pattern.length;if(p>D){let g=0;const f=p%D,m=p-f;for(;g<m;)h(this.pattern.substr(g,D),g),g+=D;if(f){const A=p-D;h(this.pattern.substr(A),A)}}else h(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,ignoreDiacritics:i,includeMatches:s}=this.options;if(t=e?t:t.toLowerCase(),t=i?L(t):t,this.pattern===t){let m={isMatch:!0,score:0};return s&&(m.indices=[[0,t.length-1]]),m}const{location:n,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:u,ignoreLocation:l}=this.options;let h=[],p=0,g=!1;this.chunks.forEach(({pattern:m,alphabet:A,startIndex:M})=>{const{isMatch:w,score:k,indices:v}=Ft(t,m,A,{location:n+M,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:u,includeMatches:s,ignoreLocation:l});w&&(g=!0),p+=k,w&&v&&(h=[...h,...v])});let f={isMatch:g,score:g?p/this.chunks.length:1};return g&&s&&(f.indices=h),f}}class S{constructor(t){this.pattern=t}static isMultiMatch(t){return nt(t,this.multiRegex)}static isSingleMatch(t){return nt(t,this.singleRegex)}search(){}}function nt(r,t){const e=r.match(t);return e?e[1]:null}class It extends S{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Tt extends S{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const i=t.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}}class Lt extends S{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Ot extends S{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class Pt extends S{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Rt extends S{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class ot extends S{constructor(t,{location:e=d.location,threshold:i=d.threshold,distance:s=d.distance,includeMatches:n=d.includeMatches,findAllMatches:o=d.findAllMatches,minMatchCharLength:c=d.minMatchCharLength,isCaseSensitive:a=d.isCaseSensitive,ignoreDiacritics:u=d.ignoreDiacritics,ignoreLocation:l=d.ignoreLocation}={}){super(t),this._bitapSearch=new st(t,{location:e,threshold:i,distance:s,includeMatches:n,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:a,ignoreDiacritics:u,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class ct extends S{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e=0,i;const s=[],n=this.pattern.length;for(;(i=t.indexOf(this.pattern,e))>-1;)e=i+n,s.push([i,e-1]);const o=!!s.length;return{isMatch:o,score:o?0:1,indices:s}}}const z=[It,ct,Lt,Ot,Rt,Pt,Tt,ot],at=z.length,Nt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,$t="|";function Ht(r,t={}){return r.split($t).map(e=>{let i=e.trim().split(Nt).filter(n=>n&&!!n.trim()),s=[];for(let n=0,o=i.length;n<o;n+=1){const c=i[n];let a=!1,u=-1;for(;!a&&++u<at;){const l=z[u];let h=l.isMultiMatch(c);h&&(s.push(new l(h,t)),a=!0)}if(!a)for(u=-1;++u<at;){const l=z[u];let h=l.isSingleMatch(c);if(h){s.push(new l(h,t));break}}}return s})}const zt=new Set([ot.type,ct.type]);class Vt{constructor(t,{isCaseSensitive:e=d.isCaseSensitive,ignoreDiacritics:i=d.ignoreDiacritics,includeMatches:s=d.includeMatches,minMatchCharLength:n=d.minMatchCharLength,ignoreLocation:o=d.ignoreLocation,findAllMatches:c=d.findAllMatches,location:a=d.location,threshold:u=d.threshold,distance:l=d.distance}={}){this.query=null,this.options={isCaseSensitive:e,ignoreDiacritics:i,includeMatches:s,minMatchCharLength:n,findAllMatches:c,ignoreLocation:o,location:a,threshold:u,distance:l},t=e?t:t.toLowerCase(),t=i?L(t):t,this.pattern=t,this.query=Ht(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:s,ignoreDiacritics:n}=this.options;t=s?t:t.toLowerCase(),t=n?L(t):t;let o=0,c=[],a=0;for(let u=0,l=e.length;u<l;u+=1){const h=e[u];c.length=0,o=0;for(let p=0,g=h.length;p<g;p+=1){const f=h[p],{isMatch:m,indices:A,score:M}=f.search(t);if(m){if(o+=1,a+=M,i){const w=f.constructor.type;zt.has(w)?c=[...c,...A]:c.push(A)}}else{a=0,o=0,c.length=0;break}}if(o){let p={isMatch:!0,score:a/o};return i&&(p.indices=c),p}}return{isMatch:!1,score:1}}}const V=[];function jt(...r){V.push(...r)}function j(r,t){for(let e=0,i=V.length;e<i;e+=1){let s=V[e];if(s.condition(r,t))return new s(r,t)}return new st(r,t)}const O={AND:"$and",OR:"$or"},K={PATH:"$path",PATTERN:"$val"},W=r=>!!(r[O.AND]||r[O.OR]),Kt=r=>!!r[K.PATH],Wt=r=>!E(r)&&J(r)&&!W(r),ut=r=>({[O.AND]:Object.keys(r).map(t=>({[t]:r[t]}))});function lt(r,t,{auto:e=!0}={}){const i=s=>{let n=Object.keys(s);const o=Kt(s);if(!o&&n.length>1&&!W(s))return i(ut(s));if(Wt(s)){const a=o?s[K.PATH]:n[0],u=o?s[K.PATTERN]:s[a];if(!y(u))throw new Error(Ct(a));const l={keyId:$(a),pattern:u};return e&&(l.searcher=j(u,t)),l}let c={children:[],operator:n[0]};return n.forEach(a=>{const u=s[a];E(u)&&u.forEach(l=>{c.children.push(i(l))})}),c};return W(r)||(r=ut(r)),i(r)}function Ut(r,{ignoreFieldNorm:t=d.ignoreFieldNorm}){r.forEach(e=>{let i=1;e.matches.forEach(({key:s,norm:n,score:o})=>{const c=s?s.weight:null;i*=Math.pow(o===0&&c?Number.EPSILON:o,(c||1)*(t?1:n))}),e.score=i})}function Gt(r,t){const e=r.matches;t.matches=[],_(e)&&e.forEach(i=>{if(!_(i.indices)||!i.indices.length)return;const{indices:s,value:n}=i;let o={indices:s,value:n};i.key&&(o.key=i.key.src),i.idx>-1&&(o.refIndex=i.idx),t.matches.push(o)})}function Yt(r,t){t.score=r.score}function Qt(r,t,{includeMatches:e=d.includeMatches,includeScore:i=d.includeScore}={}){const s=[];return e&&s.push(Gt),i&&s.push(Yt),r.map(n=>{const{idx:o}=n,c={item:t[o],refIndex:o};return s.length&&s.forEach(a=>{a(n,c)}),c})}class F{constructor(t,e={},i){this.options={...d,...e},this.options.useExtendedSearch,this._keyStore=new St(this.options.keys),this.setCollection(t,i)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof H))throw new Error(At);this._myIndex=e||it(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){_(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const e=[];for(let i=0,s=this._docs.length;i<s;i+=1){const n=this._docs[i];t(n,i)&&(this.removeAt(i),i-=1,s-=1,e.push(n))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:i,includeScore:s,shouldSort:n,sortFn:o,ignoreFieldNorm:c}=this.options;let a=y(t)?y(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Ut(a,{ignoreFieldNorm:c}),n&&a.sort(o),Z(e)&&e>-1&&(a=a.slice(0,e)),Qt(a,this._docs,{includeMatches:i,includeScore:s})}_searchStringList(t){const e=j(t,this.options),{records:i}=this._myIndex,s=[];return i.forEach(({v:n,i:o,n:c})=>{if(!_(n))return;const{isMatch:a,score:u,indices:l}=e.searchIn(n);a&&s.push({item:n,idx:o,matches:[{score:u,value:n,norm:c,indices:l}]})}),s}_searchLogical(t){const e=lt(t,this.options),i=(c,a,u)=>{if(!c.children){const{keyId:h,searcher:p}=c,g=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(a,h),searcher:p});return g&&g.length?[{idx:u,item:a,matches:g}]:[]}const l=[];for(let h=0,p=c.children.length;h<p;h+=1){const g=c.children[h],f=i(g,a,u);if(f.length)l.push(...f);else if(c.operator===O.AND)return[]}return l},s=this._myIndex.records,n={},o=[];return s.forEach(({$:c,i:a})=>{if(_(c)){let u=i(e,c,a);u.length&&(n[a]||(n[a]={idx:a,item:c,matches:[]},o.push(n[a])),u.forEach(({matches:l})=>{n[a].matches.push(...l)}))}}),o}_searchObjectList(t){const e=j(t,this.options),{keys:i,records:s}=this._myIndex,n=[];return s.forEach(({$:o,i:c})=>{if(!_(o))return;let a=[];i.forEach((u,l)=>{a.push(...this._findMatches({key:u,value:o[l],searcher:e}))}),a.length&&n.push({idx:c,item:o,matches:a})}),n}_findMatches({key:t,value:e,searcher:i}){if(!_(e))return[];let s=[];if(E(e))e.forEach(({v:n,i:o,n:c})=>{if(!_(n))return;const{isMatch:a,score:u,indices:l}=i.searchIn(n);a&&s.push({score:u,key:t,value:n,idx:o,norm:c,indices:l})});else{const{v:n,n:o}=e,{isMatch:c,score:a,indices:u}=i.searchIn(n);c&&s.push({score:a,key:t,value:n,norm:o,indices:u})}return s}}F.version="7.1.0",F.createIndex=it,F.parseIndex=Dt,F.config=d,F.parseQuery=lt,jt(Vt);const Xt=[{id:"coup_001",code:"SAVE20",merchant_id:"amazon",discount_type:"percentage",discount_value:20,description:"20% off your entire order",success_rate:.92,last_verified_ts:17088768e5,minimum_purchase:50,categories:["electronics","books"]},{id:"coup_002",code:"FREESHIP50",merchant_id:"amazon",discount_type:"free_shipping",discount_value:0,description:"Free shipping on orders over $50",success_rate:.98,last_verified_ts:17089632e5,minimum_purchase:50},{id:"coup_003",code:"TECH15OFF",merchant_id:"bestbuy",discount_type:"percentage",discount_value:15,description:"15% off tech accessories",success_rate:.87,last_verified_ts:17087904e5,categories:["electronics","accessories"]},{id:"coup_004",code:"STUDENT10",merchant_id:"amazon",discount_type:"percentage",discount_value:10,description:"10% student discount",success_rate:.75,last_verified_ts:1708704e6},{id:"coup_005",code:"BOGO50",merchant_id:"target",discount_type:"bogo",discount_value:50,description:"Buy one get one 50% off",success_rate:.89,last_verified_ts:17088768e5,categories:["clothing","home"]},{id:"coup_006",code:"FLASH25",merchant_id:"walmart",discount_type:"percentage",discount_value:25,description:"Flash sale - 25% off",success_rate:.65,last_verified_ts:17086176e5,expires_at:17090496e5},{id:"coup_007",code:"SAVE5FLAT",merchant_id:"ebay",discount_type:"fixed",discount_value:5,description:"$5 off any purchase",success_rate:.94,last_verified_ts:17089632e5,minimum_purchase:25},{id:"coup_008",code:"NEWYEAR30",merchant_id:"target",discount_type:"percentage",discount_value:30,description:"New Year special - 30% off",success_rate:.45,last_verified_ts:17085312e5,expires_at:17067456e5},{id:"coup_009",code:"MEMBER15",merchant_id:"bestbuy",discount_type:"percentage",discount_value:15,description:"Members get 15% off",success_rate:.82,last_verified_ts:17087904e5},{id:"coup_010",code:"TOOLS20",merchant_id:"homedepot",discount_type:"percentage",discount_value:20,description:"20% off power tools",success_rate:.78,last_verified_ts:1708704e6,categories:["tools","hardware"]}],Zt=[{id:"prod_001",name:"Wireless Noise-Canceling Headphones",price:249.99,original_price:299.99,rating:4.5,review_count:1250,categories:["electronics","audio","headphones"],merchant_id:"amazon",description:"Premium over-ear headphones with active noise cancellation"},{id:"prod_002",name:"Smart 4K TV - 55 inch",price:599.99,original_price:799.99,rating:4.3,review_count:890,categories:["electronics","tv","smart-home"],merchant_id:"bestbuy",description:"Ultra HD Smart TV with HDR and streaming apps"},{id:"prod_003",name:"Instant Pot Duo 7-in-1",price:79.99,rating:4.6,review_count:5430,categories:["kitchen","appliances","cooking"],merchant_id:"amazon",description:"Multi-use programmable pressure cooker"},{id:"prod_004",name:"Cordless Drill Set",price:129.99,original_price:169.99,rating:4.4,review_count:720,categories:["tools","power-tools","hardware"],merchant_id:"homedepot",description:"20V MAX Cordless Drill with 2 batteries and charger"},{id:"prod_005",name:"Yoga Mat - Extra Thick",price:29.99,rating:4.7,review_count:2100,categories:["sports","fitness","yoga"],merchant_id:"target",description:"Non-slip exercise mat with carrying strap"},{id:"prod_006",name:"Coffee Maker with Grinder",price:149.99,original_price:199.99,rating:4.2,review_count:450,categories:["kitchen","appliances","coffee"],merchant_id:"walmart",description:"Automatic coffee maker with built-in burr grinder"},{id:"prod_007",name:"Gaming Laptop - RTX 4060",price:1299.99,original_price:1499.99,rating:4.5,review_count:320,categories:["electronics","computers","gaming"],merchant_id:"bestbuy",description:"High-performance gaming laptop with RTX graphics"},{id:"prod_008",name:"Air Fryer - 6 Quart",price:89.99,rating:4.4,review_count:1890,categories:["kitchen","appliances","cooking"],merchant_id:"target",description:"Digital air fryer with 8 preset cooking programs"},{id:"prod_009",name:"Security Camera System",price:299.99,original_price:399.99,rating:4.3,review_count:560,categories:["electronics","security","smart-home"],merchant_id:"amazon",description:"4-camera wireless security system with night vision"},{id:"prod_010",name:"Electric Lawn Mower",price:249.99,rating:4.1,review_count:410,categories:["outdoor","lawn-care","tools"],merchant_id:"lowes",description:"Cordless electric lawn mower with 21-inch cutting deck"}],Jt=[{contributor_id:"contrib_001",reputation:95,rank_badge:"platinum",total_verifications:1250,success_rate:.94},{contributor_id:"contrib_002",reputation:88,rank_badge:"gold",total_verifications:780,success_rate:.89},{contributor_id:"contrib_003",reputation:72,rank_badge:"silver",total_verifications:450,success_rate:.85},{contributor_id:"contrib_004",reputation:98,rank_badge:"platinum",total_verifications:2100,success_rate:.96},{contributor_id:"contrib_005",reputation:65,rank_badge:"silver",total_verifications:320,success_rate:.82},{contributor_id:"contrib_006",reputation:45,rank_badge:"bronze",total_verifications:120,success_rate:.75},{contributor_id:"contrib_007",reputation:82,rank_badge:"gold",total_verifications:650,success_rate:.88},{contributor_id:"contrib_008",reputation:91,rank_badge:"platinum",total_verifications:1450,success_rate:.92},{contributor_id:"contrib_009",reputation:58,rank_badge:"bronze",total_verifications:210,success_rate:.78},{contributor_id:"contrib_010",reputation:76,rank_badge:"silver",total_verifications:520,success_rate:.86},{contributor_id:"contrib_011",reputation:93,rank_badge:"platinum",total_verifications:1780,success_rate:.95},{contributor_id:"contrib_012",reputation:69,rank_badge:"silver",total_verifications:380,success_rate:.83},{contributor_id:"contrib_013",reputation:52,rank_badge:"bronze",total_verifications:150,success_rate:.76},{contributor_id:"contrib_014",reputation:87,rank_badge:"gold",total_verifications:890,success_rate:.9},{contributor_id:"contrib_015",reputation:79,rank_badge:"gold",total_verifications:620,success_rate:.87},{contributor_id:"contrib_016",reputation:96,rank_badge:"platinum",total_verifications:2450,success_rate:.97},{contributor_id:"contrib_017",reputation:61,rank_badge:"silver",total_verifications:280,success_rate:.8},{contributor_id:"contrib_018",reputation:73,rank_badge:"silver",total_verifications:490,success_rate:.84},{contributor_id:"contrib_019",reputation:84,rank_badge:"gold",total_verifications:750,success_rate:.89},{contributor_id:"contrib_020",reputation:41,rank_badge:"bronze",total_verifications:95,success_rate:.72},{contributor_id:"contrib_021",reputation:77,rank_badge:"silver",total_verifications:560,success_rate:.86},{contributor_id:"contrib_022",reputation:90,rank_badge:"platinum",total_verifications:1320,success_rate:.93},{contributor_id:"contrib_023",reputation:55,rank_badge:"bronze",total_verifications:180,success_rate:.77},{contributor_id:"contrib_024",reputation:81,rank_badge:"gold",total_verifications:690,success_rate:.88},{contributor_id:"contrib_025",reputation:99,rank_badge:"platinum",total_verifications:3200,success_rate:.98}],qt=[{domain:"amazon.com",selectors:{priceElement:".a-price-whole, .a-price-range",couponInput:"#spc-gcpromoinput",applyButton:"#gcApplyButtonId",cartTotal:".sc-subtotal-amount-buybox"}},{domain:"bestbuy.com",selectors:{priceElement:".pricing-price__regular-price, .priceView-hero-price",couponInput:"#cartApp input[name='promoCode']",applyButton:".promo-code__submit-btn",cartTotal:".order-summary__price"}},{domain:"target.com",selectors:{priceElement:"[data-test='product-price']",couponInput:"#promoCodeEntry",applyButton:"[data-test='apply-promo-code-button']",cartTotal:"[data-test='cart-summary-value']"}},{domain:"walmart.com",selectors:{priceElement:".price-main .price-characteristic",couponInput:"input[name='promoCode']",applyButton:"button[data-automation-id='promo-apply-button']",cartTotal:".cart-total-value"}},{domain:"ebay.com",selectors:{priceElement:".x-price-primary, .vi-VR-cvipPrice",couponInput:"#redemptionCode",applyButton:"#redemptionSubmit",cartTotal:".total-row .val"}},{domain:"homedepot.com",selectors:{priceElement:".price-format__main-price",couponInput:"#promoInput",applyButton:"#promoApplyButton",cartTotal:".checkout__total-price"}},{domain:"lowes.com",selectors:{priceElement:".main-price",couponInput:"#promo-code-input",applyButton:"#promo-apply-btn",cartTotal:".order-total-value"}},{domain:"wayfair.com",selectors:{priceElement:".SFPrice",couponInput:"#PromoCodeInput",applyButton:"#PromoApplyButton",cartTotal:".CartSummary-total"}}],U=Xt,P=Zt,dt=Jt,G=qt,te=new F(P,{keys:["name","description","categories"],threshold:.4,includeScore:!0});class Y{static getCoupons(t){return U.filter(e=>e.merchant_id===t||e.merchant_id===this.extractMerchantId(t))}static getAllCoupons(){return[...U]}static getCouponById(t){return U.find(e=>e.id===t)}static searchProducts(t,e=10){return te.search(t,{limit:e}).map(s=>s.item)}static getProductById(t){return P.find(e=>e.id===t)}static getProductsByCategory(t){return P.filter(e=>e.categories.some(i=>i.toLowerCase().includes(t.toLowerCase())))}static getAllProducts(){return[...P]}static getContributor(t){return dt.find(e=>e.contributor_id===t)}static getTopContributors(t=10){return[...dt].sort((e,i)=>i.reputation-e.reputation).slice(0,t)}static getSiteConfig(t){return G.find(e=>t.includes(e.domain)||e.domain.includes(t))}static isSiteSupported(t){return G.some(e=>t.includes(e.domain)||e.domain.includes(t))}static getAllSupportedSites(){return[...G]}static extractMerchantId(t){const e=t.match(/(?:www\.)?([^.]+)\./);return e?e[1].toLowerCase():t.toLowerCase()}static async simulateApiDelay(t=300){return new Promise(e=>setTimeout(e,t))}static getMerchantHash(t){let e=0;for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);e=(e<<5)-e+s,e=e&e}return Math.abs(e).toString(16)}}class ee{sidebarIframe;sidebarContainer;isOpen=!1;modelStatus="loading";constructor(){this.init()}async init(){const t=window.location.hostname;if(!Y.isSiteSupported(t)){console.log("Site not supported:",t);return}this.createToggleButton(),chrome.runtime.onMessage.addListener((e,i,s)=>{this.handleMessage(e)}),this.checkModelStatus(),this.isCheckoutPage()&&setTimeout(()=>this.openSidebar(),1e3)}createToggleButton(){const t=document.createElement("button");t.id="simplycodes-toggle",t.innerHTML=`
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9 11H7V13H9V11Z" fill="currentColor"/>
        <path d="M13 11H11V13H13V11Z" fill="currentColor"/>
        <path d="M17 11H15V13H17V11Z" fill="currentColor"/>
        <path d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4ZM20 18H4V8H20V18Z" fill="currentColor"/>
      </svg>
      <span class="simplycodes-badge">SC</span>
    `,t.style.cssText=`
      position: fixed;
      right: 20px;
      bottom: 80px;
      width: 56px;
      height: 56px;
      border-radius: 28px;
      background: #0ea5e9;
      color: white;
      border: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      cursor: pointer;
      z-index: 999998;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    `,t.addEventListener("mouseenter",()=>{t.style.transform="scale(1.1)",t.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.2)"}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)",t.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"}),t.addEventListener("click",()=>{this.isOpen?this.closeSidebar():this.openSidebar()}),document.body.appendChild(t)}createSidebar(){this.sidebarContainer=document.createElement("div"),this.sidebarContainer.id="simplycodes-sidebar-container",this.sidebarContainer.style.cssText=`
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100%;
      background: white;
      box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
      z-index: 999999;
      transition: right 0.3s ease;
    `,this.sidebarIframe=document.createElement("iframe"),this.sidebarIframe.id="simplycodes-sidebar",this.sidebarIframe.src=chrome.runtime.getURL("sidebar/index.html"),this.sidebarIframe.style.cssText=`
      width: 100%;
      height: 100%;
      border: none;
    `,this.sidebarContainer.appendChild(this.sidebarIframe),document.body.appendChild(this.sidebarContainer),window.addEventListener("message",t=>{t.source===this.sidebarIframe?.contentWindow&&this.handleIframeMessage(t.data)})}openSidebar(){this.sidebarContainer||this.createSidebar(),setTimeout(()=>{this.sidebarContainer&&(this.sidebarContainer.style.right="0",this.isOpen=!0)},100),this.sendPageData()}closeSidebar(){this.sidebarContainer&&(this.sidebarContainer.style.right="-400px",this.isOpen=!1)}async sendPageData(){const t={url:window.location.href,title:document.title,price:this.extractPrice(),cartTotal:this.extractCartTotal(),productInfo:this.extractProductInfo()},e=await this.sendToBackground({type:"GET_COUPONS",payload:{domain:window.location.hostname,cartTotal:t.cartTotal}});e.success&&this.postToSidebar({type:"PAGE_DATA",payload:{...t,coupons:e.data.coupons,modelStatus:this.modelStatus}})}extractPrice(){const t=Y.getSiteConfig(window.location.hostname);if(!t)return null;const e=document.querySelector(t.selectors.priceElement);if(!e)return null;const i=e.textContent||"",s=parseFloat(i.replace(/[^0-9.]/g,""));return isNaN(s)?null:s}extractCartTotal(){const t=Y.getSiteConfig(window.location.hostname);if(!t||!t.selectors.cartTotal)return null;const e=document.querySelector(t.selectors.cartTotal);if(!e)return null;const i=e.textContent||"",s=parseFloat(i.replace(/[^0-9.]/g,""));return isNaN(s)?null:s}extractProductInfo(){const t={title:document.title,url:window.location.href},e=document.querySelector("h1");e&&(t.productName=e.textContent?.trim());const i=document.querySelector('img[alt*="product"], img[alt*="item"], .product-image img');return i instanceof HTMLImageElement&&(t.imageUrl=i.src),t}isCheckoutPage(){const t=window.location.href.toLowerCase();return["checkout","cart","basket","order","payment"].some(i=>t.includes(i))}async checkModelStatus(){const t=await this.sendToBackground({type:"MODEL_STATUS",payload:{}});t.success&&(this.modelStatus=t.data.status,this.updateModelStatus(this.modelStatus))}updateModelStatus(t){this.modelStatus=t;const e=document.getElementById("simplycodes-toggle");if(e){const i=e.querySelector(".simplycodes-badge");if(i)switch(t){case"loading":i.textContent="...";break;case"ready":i.textContent="SC";break;case"error":i.textContent="!";break}}this.isOpen&&this.postToSidebar({type:"MODEL_STATUS",payload:{status:t}})}handleMessage(t){switch(t.type){case"MODEL_STATUS":this.updateModelStatus(t.payload.status);break;case"MODEL_PROGRESS":console.log("Model loading progress:",t.payload);break}}async handleIframeMessage(t){switch(t.type){case"APPLY_COUPON":const e=await this.sendToBackground({type:"APPLY_COUPON",payload:{code:t.payload.code,tabId:0}});this.postToSidebar({type:"COUPON_APPLIED",payload:e});break;case"SEND_CHAT":const i=await this.sendToBackground({type:"CHAT_MESSAGE",payload:t.payload});this.postToSidebar({type:"CHAT_RESPONSE",payload:i});break;case"CLOSE_SIDEBAR":this.closeSidebar();break}}sendToBackground(t){return new Promise(e=>{chrome.runtime.sendMessage(t,e)})}postToSidebar(t){this.sidebarIframe?.contentWindow&&this.sidebarIframe.contentWindow.postMessage(t,"*")}}new ee;const ht=document.createElement("style");ht.textContent=`
  .simplycodes-badge {
    position: absolute;
    top: -4px;
    right: -4px;
    background: #ef4444;
    color: white;
    font-size: 10px;
    font-weight: bold;
    padding: 2px 4px;
    border-radius: 8px;
    min-width: 16px;
    text-align: center;
  }
`,document.head.appendChild(ht)})();
